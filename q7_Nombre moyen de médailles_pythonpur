import pandas as pd


def moyenne_medailles_pur(df):
    """
    Version Python pur.
    Calcule la moyenne de médailles sur l'ensemble des
    années olympiques.

    Paramètre :
    - data : liste de dictionnaires (issue de csv.DictReader)

    Retourne :
    - Un tuple représentant la moyenne des médailles gagnées par type
    de sport sur toutes les années des JO
    (moyenne pour les sports individuels ,
    moyenne pour les sports collectifs, moyenne totale)
    """
    # Conversion en dataframe la liste
    df = pd.DataFrame(df)

    # Liste des sports collectifs
    collective_sports = [
        'Basketball', 'Football', 'Handball', 'Hockey', 'Water Polo',
        'Rugby Sevens', 'Baseball', 'Softball', 'Volleyball']

    # Catégorie du sport
    df['Sport_category'] = df['Sport'].apply(
        lambda x: 'collectif' if x in collective_sports else 'individuel')

    # Supprimer les lignes sans médaille
    medals_df = df.dropna(subset=['Medal'])

    # Séparer les catégories
    indiv_medals = medals_df[medals_df['Sport_category'] == 'individuel']
    coll_medals = medals_df[medals_df['Sport_category'] == 'collectif']

    # Pour les sports collectifs, une médaille par
    # pays/année/événement/médaille
    coll_medals_unique = coll_medals.drop_duplicates(
        subset=['Team', 'Year', 'Event', 'Medal'])

    # Compter par pays
    indiv_counts = indiv_medals['Team'].value_counts()
    coll_counts = coll_medals_unique['Team'].value_counts()
    total_counts = indiv_counts.add(coll_counts, fill_value=0)

    # Moyennes
    avg_indiv = indiv_counts.mean()
    avg_coll = coll_counts.mean()
    avg_total = total_counts.mean()

    return avg_indiv, avg_coll, avg_total

